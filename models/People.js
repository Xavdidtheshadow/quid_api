var mongoose = require('mongoose');

var PersonSchema = new mongoose.Schema({
  // _id, generated by mongo
  name: {type: String, reqiured: true, trim: true},

  // these must be unique
  email: {type: String, lowercase: true, trim: true},
  
  // server side email validaion
  // email: {type: String, match: [/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/, 'Invalid Email']},

  // it doesn't look like I can format this before instert
  phone: String,

  level: {type: Number, min: 1, max: 4, default: 2},

  certifications: {
    ar: {type: Boolean, default: false},
    sr: {type: Boolean, default: false},
    hr: {type: Boolean, default: false},
  },

  crews: [String],

  // primary/current team is always first
  // this is no longer an array. that's silly.
  team: {type: {type: mongoose.Schema.Types.ObjectId, ref: "Team"}, default: null},
  // previous teams
  requests: {type: [{type: mongoose.Schema.Types.ObjectId, ref: "Team"}], default: []}
});

mongoose.model('Person', PersonSchema);